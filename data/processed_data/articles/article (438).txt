БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

УДК 004.032.26 + 622.248.54 

РАЗРАБОТКА НЕЙРОСЕТЕВОЙ МОДЕЛИ ПРОГНОЗИРОВАНИЯ  
ПРИХВАТОВ КОЛОНН БУРИЛЬНЫХ ТРУБ 
●●●●●● 
DEVELOPMENT OF NEURAL NETWORK MODEL  
FOR PREDICTING DRILL PIPE STICKING 

Кодиров Шахбоз Шарифович 
аспирант,  
младший научный сотрудник НИЛ  
«Технической самодиагностики  
и самоконтроля приборов и систем»,  
Южно-Уральский государственный университет (НИУ) 

Qodirov Shahboz Sharifovich 
Ph.D. student,  
Junior Researcher Self-Validating Sensors,  
Systems, and Advanced Instrumentation  
Laboratory, 
South Ural State University  
(National Research University) 

Аннотация. Работа посвящена разработке модели искусствен-
ной нейронной сети для прогнозирования прихвата колонны бу-
рильных  труб.  Отличительной  особенностью  предлагаемого 
метода  является  то,  что  полученная  модель  прогнозирования 
может адаптироваться к новым данным, что часто происходит 
при бурении скважин на новых месторождениях. 

Annotation. The work is devoted to the devel-
opment of neural network model for predicting 
drill pipe sticking. The distinctive feature of the 
proposed method is that the obtained predict-
ing model can adapt to new data, which often 
occurs when drilling wells in new fields. 

Ключевые  слова:  прихват  колонн  бурильных  труб,  распозна-
вание и прогнозирование, нейронные сети, многослойный пер-
септрон, нормализация данных, кросс-валидация по k-блокам. 

Keywords:  drill  string  stuck,  recognition  and 
prediction, neural networks, multilayer percep-
tron,  data  normalization,  k-fold  cross-valida-
tion. 

Б 

урение скважин для разведки и разработки новых месторождений, а также добычи углево-
дородных ресурсов всегда было и остается чрезвычайно капиталоемким для нефтегазодо-
бывающих  организаций.  Получение  высоких  технико-экономических  показателей  бурения  во  многом 
зависит от успешности преодоления осложнений и аварий. При этом риск возникновения аварий в со-
временных  условиях  бурения  нефтяных  и  газовых  скважин  (разнообразие  геологического  строения 
районов, глубина скважин, высокие давления, температура и солевая агрессия, наличие неустойчивых 
пород, сложность конструкций и конфигураций скважин) очень высок. 

Наиболее распространенным и трудоемким видом аварий в процессе бурения скважин является 
прихват бурильной колонны, поэтому вопросам прогнозирования и идентификаций прихватов колонн 
бурильных труб отводится первостепенная роль. 

Прихват – это непредвиденный процесс при сооружении скважин, характеризующийся потерей 
подвижности колонны труб или скважинных приборов при приложении к ним максимально допустимых 
нагрузок с учетом запаса прочности труб и применяемого оборудования [1]. Время простоя при ликви-
дации прихватов приводит к значительным финансовым убыткам. Следовательно, разработка методов 
прогнозирования и распознавания прихватов позволит получить значительную экономическую выгоду 
за счет сокращения времени на их ликвидацию [1–14].  

Коллективом ученых в период 70–80-х годов XX века А.К. Самотоем, А.Г. Аветисовым, Н.Н. Ко-
шелевым, Н.Г. Аветисяном, М.М. Ахмадуллиным, С.Р. Хлебниковым впервые была разработана про-
цедура распознавания, прогнозирования и предупреждения прихватов колонн статистическими мето-
дами, а именно методом последовательной диагностической процедуры [1–6]. Данный метод авторы 
использовали для прогнозирования возникновения трех типов прихватов на основе промысловых дан-
ных. Авторы утверждают, что достоверность прогнозирования этого метода высокая (с вероятностью 
от  0,7 и  более).  Следует  отметить,  что  такой подход  требует  значительного  времени  на  проведение 
процедуры  прогнозирования  и  получение  больших  статистических  данных  о  прихватах.  Следова-
тельно, применение данного метода ограничено, особенно, в геологически неразведанных районах. 

Исследователем Ф.Н. Абу-Абед предложен метод обнаружения предаварийных ситуаций в про-
цессе промышленного бурения нефтяных скважин [8–14]. В работах автора применяется кластериза-
ция данных и последующее прогнозирование на основе нейронных сетей. В качестве входного набора 
данных автором использованы статистические данные об авариях, источник данных – библиотека про-
граммного  обеспечения  станции  геолого-технологического  исследования.  В  качестве  выходного  сиг-
нала  использованы  два  состояния  текущей  ситуации:  «штатная  ситуация»  и  «предаварийная  ситуа-
ция».  Работа  автора  охватывает  все  возможные  виды  аварий  и  некоторые  осложнения  в  целом 

145 

 
 
 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

(газонефтеводопроявление и выбросы, поглощения бурового и тампонажного раствора, прихват буро-
вого инструмента, обвал стенок скважины) без детализации причин их возникновения. Такой подход не 
позволяет  оценить  влияние  конкретных факторов на  развитие  того или иного  вида  аварии,  следова-
тельно, устранение аварийных ситуаций на ранних стадиях становится невозможным. 

Американскими учеными Хьюстонского университета и компании Халлибертон США (A. Murillo, 
J. Neuman, R. Samuel) предлагается прогнозирование дифференциального и механического прихватов 
бурильных труб методами нечеткой логики и нейронной сети в сочетании с моделью дискриминантного 
анализа [15]. Исследование проведено на основе полевых производственных данных Халлибертон. В 
качестве входных данных были использованы параметры режимов бурения, глубина скважины, момент 
вращения, давление на стояке бурового насоса, диаметр долота, геометрия компоновки низа буриль-
ной  колонны  и  параметры  бурового  раствора,  в  том  числе  реологические.  В  результате  полученная 
модель имеет достаточно высокую точность прогнозирования. Несмотря на то, что работа в большей 
степени посвящена  дифференциальному прихвату  труб,  авторы  не  учитывали  в  своей модели  типы 
горных пород. Однако, именно данный фактор в большей степени влияет на природу возникновения 
дифференциального прихвата [1, 7]. 

Совместно с американскими и иранскими учеными (N.М. Elahi, P. Ezzatyar, J. Saeid) предлагается 
прогнозирование дифференциального прихвата бурильных труб методом нечеткой логики и активного 
обучения [16]. В качестве входных элементов данных применяются следующие факторы: глубина сква-
жины, предел  текучести  бурового  раствора  (БР),  тип БР,  статическое  напряжение сдвига  при  1 и  10 
минут покоя, тип смазочных добавок, содержание твердых частиц, водоотдача БР, толщина фильтра-
ционной  корки,  пластическая  вязкость,  осевая  нагрузка  на  долото  и  частота  вращения инструмента. 
Авторы  утверждают,  что  полученная  ими  модель,  по  сравнению  с  существующими  моделями  [15], 
имеет высокую точность прогнозирования возникновения дифференциального прихвата. Несомненная 
важность этой работы состоит в том, что в работе применяется нормализация входных данных, за счет 
чего повышается точность работы модели. Однако, в работе так же не учитываются типы горных пород 
в качестве входных данных. 

Таким образом, при наличии существенного задела по диагностике прихватов колонн бурильных 
труб многие свойства и механизмы возникновения прихватов недостаточно изучены. В данной работе 
представлен новый метод прогнозирования прихватов колонн бурильных труб на основе искусственной 
нейронной сети, при разработке которой были учтены наиболее важные факторы, влияющие на воз-
никновение прихватов. 

1.  Подготовка данных 

    1.1   Выбор и преобразование набора входных данных 

Успешное обнаружение и прогнозирование прихватов колонн бурильных труб возможно только 
при тщательном анализе комбинаций факторов, степень влияния которых, разными исследователями 
определяется субъективно [1–7].  

В  качестве  набора  данных  о  прихватах  в  работе  были  использованы  промысловые  архивные 

данные ВНИИКРнефти по 92 прихватам скважин [1–6]. 

Рассматриваемые данные представляют собой следующие компоненты вектора состояния сква-
жины (X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16, X17, X18), где: X1 – глубина, на которой 
находится долото в момент прихвата, м; X2 – тип породы в зоне прихвата; X3 – пластовое давление в 
зоне  прихвата,  кгс/см²;  X4  –  разность  между  давлением  столба  промывочной  жидкости  и  пластовым 
давлением,  кгс/см²;  X5  –  плотность  бурового  раствора,  г/см³;  X6  –  условная  вязкость,  с;  X7  –  СНС1, 
мгс/см²;  X8  –  CHC10,  мгс/см²;  X9  –  водоотдача  бурового  раствора,  см³/30  мин;  X10  –  длина  УБТ,  м;                         
X11  –  зазор  между  стенкой  скважины  и  УБТ,  мм;  X12  –  угол  искривления  ствола  скважины,  градус;              
X13  –  температура  на  глубине прихвата, °C;  X14  –  количество  нефти  в  растворе,  %;  X15  – понизители 
вязкости; X16 – понизители водоотдачи; X17 – ингибирующие добавки; X18 – смазочные добавки. 

Перечень компонентов вектора состояния скважины довольно представителен и при этом не про-
тиворечит набору априорных факторов, оказывающих первостепенное влияние на возникновение при-
хватов [2]. 

Для повышения информативности исходного вектора состояния ряд элементов вектора (X2, X15, 
X16,  X17,  X18)  был  разделен  на  субэлементы. Каждому  субэлементу  данных  было присвоено  долевое 
значение в соответствии своего основного элемента данных (см. табл. 1). Такое разделение позволило 
повысить репрезентативность выборки для нейронной сети (НС) и в дальнейшем, улучшить качество 
ее работы. 

Таким образом, имеются 32 компоненты вектора состояния, которые в наибольшей степени ха-
рактеризуют состояние колонны бурильных труб, находящихся в стволе скважины. В качестве выход-
ной информации о прихвате рассматривается 4 состояния: Y1 – прихват под действием перепада дав-
ления; Y2 – прихват (заклинивание) инструмента при его движении в скважине; Y3 – прихват, вслед-
ствие сужения сечения ствола скважины (в результате оседания шлама, утяжелителя, осыпей, обва-
лов, выпучивания пород, сальникообразования и т.п.); Y4 – отсутствует прихват. 

146 

 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

Таблица 1 – Разделение элементов данных на субэлементы 

X2 

X15 

X16 

X17 

1

.

2
X

2

.

2
X

3

.

2
X

4

.

2
X

.

а
т
а
в
х
и
р
п
е
н
о
з
в
ы
д
о
р
о
п

п
и
Т

%

,

а
н
и
л
Г

.

а
т
а
в
х
и
р
п
е
н
о
з
в
ы
д
о
р
о
п

п
и
Т

%

,
т
и
л
л
и
г
р
А

.

а
т
а
в
х
и
р
п
е
н
о
з
в
ы
д
о
р
о
п

п
и
Т

%

,
к
и
н
а
ч
с
е
П

.

а
т
а
в
х
и
р
п
е
н
о
з
в
ы
д
о
р
о
п

п
и
Т

%

,
ь
л
о
С

1

.

5
1
X

%

,

С
Л
Х
Ф
и
т
с
о
к
з
я
в

ь
л
е
т
и
з
и
н
о
П

2

.

5
1
X

%

,

Н
Ф
П
Т
и
т
с
о
к
з
я
в

ь
л
е
т
и
з
и
н
о
П

3

.

5
1
X

%

,

Л
И
З
К
О
и
т
с
о
к
з
я
в

ь
л
е
т
и
з
и
н
о
П

4

.

5
1
X

%

,

Р
Щ
У
и
т
с
о
к
з
я
в

ь
л
е
т
и
з
и
н
о
П

1

.

6
1
X

%

,

Б
С
С
К
и
ч
а
д
т
о
о
д
о
в

ь
л
е
т
и
з
и
н
о
П

2

.

6
1
X

%

,

Н
А
П
И
Г
и
ч
а
д
т
о
о
д
о
в

ь
л
е
т
и
з
и
н
о
П

3

.

6
1
X

%

,

Ц
М
К
и
ч
а
д
т
о
о
д
о
в

ь
л
е
т
и
з
и
н
о
П

4

.

6
1
X

%

,

Р
Щ
У
и
ч
а
д
т
о
о
д
о
в

ь
л
е
т
и
з
и
н
о
П

1

.

7
1
X

%

,

Л
Е
М
и
к
в
а
б
о
д
е
и
щ
ю
у
р
и
б
и
г
н
И

2

.

7
1
X

и
к
в
а
б
о
д
е
и
щ
ю
у
р
и
б
и
г
н
И

%

,

О
Л
К
Е
Т
С
Ж

.

3

.

7
1
X

%

,

Ь
Л
О
С
и
к
в
а
б
о
д
е
и
щ
ю
у
р
и
б
и
г
н
И

4

.

7
1
X

и
к
в
а
б
о
д
е
и
щ
ю
у
р
и
б
и
г
н
И

%

,

Ь
Т
С
Е
В
В
З
И

1

.

8
1
X

%

,
ь
т
ф
е
Н
и
к
в
а
б
о
д
е
и
щ
ю
а
в
ы
з
а
м
С

X18 

2

.

8
1
X

,

Т
И
Ф
А
Р
Г
и
к
в
а
б
о
д
е
и
щ
ю
а
в
ы
з
а
м
С

%

3

.

8
1
X

%

,

Д
А
М
С
и
к
в
а
б
о
д
е
и
щ
ю
а
в
ы
з
а
м
С

    1.2   Обучающие, проверочные и тестовые наборы данных 

Оценка модели всегда сводится к делению доступных данных на три набора: обучающий, прове-
рочный и тестовый. Модель будет обучаться на обучающих данных, а проверка качества обучения 
будет оцениваться на проверочных. После завершение обучения модель будет тестироваться с при-
менением тестовых данных. Такой подход позволяет получить наиболее точную оценку обобщенности 
модели [19]. 

    1.3   Нормализация данных 

НС  плохо  работает  со  значениями  элементов  данных,  имеющих  самые  разные  диапазоны. 
Например, в нашем случае глубина нахождения долота от 50 м до 6000 м, плотность бурового раствора 
от  0,890  г/см³  до  1,80  г/см³  и  т.д.  Сеть  сможет  автоматически  адаптироваться  к  таким  разнородным 
данным, но это усложнит процесс обучения. На практике к таким данным принято применять нормали-
зацию.  

Нормализация – это ряд методов, стремящихся сделать сходство разных образцов более замет-
ным для модели машинного обучения, что помогает модели выделять и обобщать новые данные. Для 
данной  задачи  подходит  наиболее  распространенная  форма  нормализации,  которая  предполагает 
нормальность закона распределения данных. Суть нормализации состоит в центрирование данных и 
приведение их к единичной дисперсии: 

где    (cid:1)(cid:10) – среднее значение по признаку (cid:1)(cid:8)

(cid:1)(cid:8) − (cid:1)(cid:10)
(cid:11)

, 

(cid:1)норм(cid:6) =
 (элемента данных), (cid:11) – среднеквадратическое отклонение. 

Важно отметить, что нормализации подвергаются обучающие и проверочные данные. Тестовые 

данные не должны подвергаться нормализации [19]. 

2.  Подготовка НС 

    2.1   Тип и архитектура НС 

Существуют  различные  типы и модели искусственных  НС,  которые  различаются  по  принимае-
мым видам входной информации (графической, звуковой, текстовой, цифровой и т.д.), а также методам 
их обработки [17].  

В математическом виде функционирование нейрона k можно описать следующей парой уравнений: 

(cid:17)

(cid:13)(cid:14) = (cid:15) (cid:16)(cid:14)(cid:17)(cid:18)(cid:17)
(cid:17)(cid:19)(cid:20)

, (cid:21)(cid:14) =  (cid:23)(cid:24)(cid:13)(cid:14) + (cid:26)(cid:14)(cid:27), 

где    x1,  x2,...,  xm  –  входные  сигналы;  wk1,  wk2,...,  wkm  –  синаптические  веса  нейрона  k;  uk  – линейная 
комбинация  входных  воздействий;  bk  –  порог;  φ(.) –  функция  активации;  Yk  –  выходной  сигнал 
нейрона. 

147 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

Опираясь на существующие теории и результаты практического применение различных структур 
и моделей НС, для решения поставленной задачи была выбрана многослойная сеть с последователь-
ными слоями (cid:24)(cid:28)(cid:20), (cid:28)(cid:29), (cid:28)(cid:30)(cid:27) и полными связями между ними (модель Sequential или многослойный персеп-
трон) [17–23]. 

Основным строительным блоком НС является слой (cid:24)(cid:28)(cid:31)(cid:27). Существуют различные методики и ре-
комендации  по  расчету  количества  слоев,  но  на  практике  этот  параметр  обычно  для  каждой  задачи 
выбирается индивидуально на основе численных экспериментов. 

В качестве исходной архитектуры была выбрана следующая структура: сеть с входным слоем из 
32 нейронов с функцией активации «ReLU» и с выходным слоем из 4-х нейронов с функцией активации 
«SoftMax».  

Далее был проведен ряд экспериментов, в которых оценивалось качество работы сети при изме-
нении количества нейронов входного слоя. Результаты эксперимента (см. рис. 1., а) показали, что уве-
личение количества нейронов входного слоя до 100 приводит к максимальной точности работы сети, а 
последующее увеличение приводит к нестабильному улучшению точности. С целью нахождения более 
точного количества нейронов в этом слое, проведен повторные эксперименты в диапазоне от 92 до 108 
нейронов с шагом один нейрон. Результаты эксперимента показали, что при количестве нейронов 97, 
точность работы сети достигает максимума (см. рис. 1., а), следовательно, для выбранной сети опти-
мальное количество нейронов в первом слое составляет 97. Таким образом, эта процедура проведена 
для второго слоя (см. рис. 1., б), и определено оптимальное количество нейронов 52. Дальнейшие уве-
личение количество слоев и нейронов в этих слоях не приводит к повышению точности работы сети. 

Рисунок 1 – График точности работы сети в зависимости от количества нейронов в первом а и во втором б слое 

Исходя  из  вышесказанного,  обоснованно  выбрана  следующая  архитектура  сети:  трехслойная 
сеть, где первый слой состоит из 97 нейронов, второй из 52 и последний третий (выходной) слой со-
стоит из 4-х нейронов. Во 2-м слое применяется активационная функция «Sigmoid», следовательно, на 
выходном слое применяется активационная функция мягкого максимума «SoftMax» (см. рис. 2.). 

148 

 
 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

Рисунок 2 – Архитектура НС. Многослойная сеть с последовательными связями 

Функция  активации  ограничивает  амплитуду  выходного  сигнала  нейрона.  Эта  функция  также 
называется функцией сжатия. Такая комбинация активационных функции выбрана исходя из резуль-
татов проведенных экспериментов, которые рассмотрены в разделе «оценка качества работы сети». 

    2.2   Алгоритм и метод обучения сети 

Обучение НС – это процесс, в котором параметры НС настраиваются посредством моделирова-
ния среды, в которую эта сеть встроена. Существуют различные алгоритмы и методы обучения НС, в 
зависимости  от  архитектуры  сети  и  постановки  решаемой  задачи.  Так  как  модель  рассматриваемой 
сети – это многослойный персептрон, то целесообразно применять алгоритм обучения сети с учителем 
и методом обратного распространение ошибки (со стохастическим градиентным спуском) [17–23]. 

Для подготовки сети к обучению, прежде всего, необходимо настроить три параметра для этапа 

компиляции: 

1.  Функцию потерь – величину, которую требуется свести к минимуму в ходе обучения, поэтому 
она должна представлять собой меру успеха для решаемой нами задачи. По своим назначениям су-
ществует множество видов функции потерь. В задачах мульти-классовой классификации (прогнозиро-
вания) целесообразно применять категориальную перекрестную энтропию (Categorical cross-entropy), 
которая описывается уравнением: 

(cid:31)
 !!"# = − (cid:15) (cid:21)(cid:14)(cid:28)$%&(cid:21)’(cid:14)(,
(cid:14)(cid:19)(cid:20)
где    Y*(cid:14) − предсказанное моделью значение целевой переменной; Y(cid:14) − желаемое значение целевой 

переменной.  

2.  Оптимизатор  –  механизм,  с  помощью  которого  сеть  будет  обновлять  себя,  опираясь  на 
наблюдаемые данные и функцию потерь. Оптимизатор также определяет точный способ использова-
ния  градиента  потерь  для  изменения  параметров  (см.  рис.  3.).  Применительно  для  нашей  задачи, 
наилучшие результаты были получены при выборе оптимизатора «Adam», реализующего градиентный 
спуск с импульсом. 

3.  Метрику для мониторинга на этапах обучения и тестирования, мы выбрали «Accuracy» – 

это одна из удобных метрик качества моделей машинного обучения.  

+,,(cid:13)-.,/ (cid:24)точность(cid:27) =

количество верных ответов
общее количство ответов

. 

Она часто используется для классификации и показывает долю данных, для которых класс был 

определен правильно. 

    2.3   Настройка гиперпараметров сети 

Интуитивно гиперпараметры можно представить как параметры, которые не были извлечены из 
данных и являются рычагами управления моделью, т.е. параметры, которые можно изменять с целью 

149 

 
 
 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

улучшения качества работы модели. Под гиперпараметрами следует понимать: размер мини-выборки, 
количество нейронов входного слоя, количество скрытых слоев НС и количество эпох обучения. Опти-
мальная  настройка  гиперпараметров  может  быть  достигнута  только  в  результате  проведения  серии 
экспериментов,  в  каждом из  которых  необходимо менять  один из  гиперпараметров  и  анализировать 
изменение  качества  работы  сети.  Первоначально  эти  параметры  выбираются  произвольно.  Для  ис-
пользуемой сети числом эпох обучения было выбрано 150. Но, вскоре после проведения эксперимен-
тов и анализа результатов, был отмечен следующий факт: по мере прохождения эпох обучения, умень-
шается доля ошибки на обучающей и проверочной выборке (см. рис. 4., а). По мере увеличения эпох 
доля ошибки на проверочных данных, в отличии от доли ошибок на обучающих данных достигает 
определенного  уровня  (минимума),  после  которого  по  мере  увеличения  эпохи  начинает  увеличи-
ватся  ошибка  (происходит  переобучение  сети). В  таком случае  необходимо  остановить  процесс 
обучения на той эпохе, после которой замечено увеличение ошибок обучения сети. Судя по графику 
(рис. 4., а) оптимальное число эпох для полного цикла обучения сети составляет 50, что подтвер-
ждается результатами повторного обучения (см. Рис. 4., б). 

Рисунок 3 – Блок-схема процесса обучения сети [19] 

Рисунок 4 – График оценки ошибки сети на обучающих и проверочных данных по прохождению эпох обучения:  
а при 150 эпох; б при 50 эпох 

В результате проведенной серии экспериментов, наилучшие результаты работы сети получены 
при следующих гиперпараметрах: размер мини-выборки 1; 97 нейронов входного слоя; 1 скрытый слой 
НС; 50 эпох обучения.  

150 

 
 
 
 
 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

3.  Оценка качества работы сети 

Оценка качества работы сети проводилась методом кросс-валидации по k-блокам. Имеющийся 
набора данных случайным образом подразделялся на 20-блоков мини данных (см. рис. 5.). В качестве 
обучающей  выборки  применялись  19  из  них,  а  1-блок  мини  данных  в  качестве  проверочных.  Данное 
разбиение блоков позволило проводить обучение сети и оценку ошибки сети на этих данных. 

Рисунок 5 – Структурная схема кросс-валидации по k-блокам [20] 

Процедура повторялась 20-раз, в результате чего, получено 20 моделей с их оценками качества 
). Затем вычислялась средняя ошибка работы модели, на основе разных незави-

работы сети ( (cid:20) … .  (cid:29)?
симых блоков по формуле:  

 @ABC (cid:7)

(cid:15)  (cid:8).
(cid:8)(cid:19)(cid:20)
Метод  кросс-валидации  по  k-блокам  позволил  нам  выполнить  тонкие  настройки  модели,  т.е. 
находить оптимальные значения гиперпараметров, которые дали удовлетворительную обобщающую 
способность.  После  того  как  определены  удовлетворительные  значения  гиперпараметров,  повторно 
произведен процесс обучения модели на полном обучающем наборе. В результате получена оконча-
тельная оценка качества модели на базе независимого тестового набора.  

(cid:29)?

1
20

С учетом того, что k-блочная кросс-валидация – это метод генерирования повторных образцов 
без возврата (непересекающихся образцов), преимущество этого подхода заключается в том, что каж-
дая точка образца является частью обучающего и проверочного наборов данных ровно один раз, что в 
итоге позволяет получить более низкодисперсную оценку качества модели [20].  

В  результате  проведения  серии  экспериментов  с  различными  комбинациями  активационных 
функции и оптимизаторами, были получены ряд результатов, (см. рис. 6., а, б и в) по которым можно 
сделать вывод о целесообразности применения комбинации активационных функций, скрытого и вы-
ходного слоев «Sigmoid-SoftMax» c оптимизатором Adam. При такой комбинации достигнута высокая 
точность работы сети (93,5 %) для обрабатываемых данных. 
В заключение, необходимо отметить, следующее: 
–   в разработке полученной модели прогнозирования применялись важные и обобщающие фак-
торы, влияющие на возникновение всех видов прихватов, что позволяет прогнозировать все виды при-
хватов колонн бурильных труб; 

–   применяемый способ преобразования элементов входных данных позволяет адаптироваться 

полученной модели НС к новым выборкам, в том числе от скважин различных месторождений; 

–   экспериментальным способом обоснована архитектура сети и выявлены наилучшие гиперпа-
раметры, а также комбинация активационных функций, которые позволили получить оптимальную мо-
дель для решения данной задачи; 

–   полученная модель может применяться в процессе проектирования и бурения скважины, что 

позволит минимизировать риски возникновения непредвиденных аварий (прихватов); 

–   разработанная модель позволяет прогнозировать возникновение и определять тип прихвата 

на экспериментальных данных с точностью прогнозирования 93 %. 

151 

 
 
 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

Рисунок 6 – Точность работы сети при различных комбинациях активационных функции  
(скрытого и выходного слоя) с оптимизатороми: а – SGD; б – Adadelta; в – Adam 

Литература 

1.  Самотой А.К. Предупреждение и ликвидация прихватов труб при бурении скважин : учебное пособие. – 

М. : Недра, 1979. – 182 с. 

2.  Самотой А.К., Воротнюк О.В. Анализ априорных данных о факторах, действующих при прихвате колонны 

труб // Тр. ВНИИБТ. Борьба с осложнениями при бурении скважин. – 1973. – Вып. 7. – С. 28–37. 

3.  Аветисов А.Г., Ахмадуллин М.М., Самотой А.К. Прогнозирование, предупреждение и ликвидация прихва-
тов с использованием статистических методов // Тематический научно-технический обзор. – М. : ВНИИОЭНГ, 1977. – 
С. 75–86. 

4.  Аветисов А.Г., Ахмадуллин М.М., Кошелев Н.Н. Методическое руководство по распознаванию, прогнози-
рованию  и  предупреждению  прихватов  колонн  труб  методом  последовательной  диагностической  процедуры.  –
Краснодар : ВНИИКРнефть, 1977. – 38 с. 

5.  Мирзаджанзаде А.Х., Булатов А.И., Аветисов А.Г. Методическое руководство по применению методов 

распознавания образов при промывке и креплении скважин. – Краснодар, 1974. – 42 с. 

152 

 
 
 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

6.  Мирзаджанзаде  А.Х.,  Аветисов  А.Г., Булатов  А.И.  Методические  указания  по  применению  статистиче-

ских методов в бурении нефтяных и газовых скважин. – Краснодар, 1983. – 62 с. 

7.  Липатов Е.Ю. Исследование и разработка технологии и технических средств для предупреждения и лик-
видации прихвата бурильной колонны (на примере месторождений Среднего Приобья) : монография. – Тюмень : 
ТюмГНГУ, 2015. – 128 с. 

8.  Abu-Abed F.N. Development of Tools for the Analysis of Pre-Emergency Situations on the Drilling Rig Based 
on Neural Network Technologies // IIIrd International Innovative Mining Symposium. Environment Saving Mining Technol-
ogies. – 2018. – 41, 01025. – 8 p. – doi.org/10.1051/e3sconf/20184101025. 

9.  Абу-Абед Ф.Н. Надежность объектов нефтегазодобывающей промышленности // Газовая промышлен-

ность. – 2015. – № S720 (720). – С. 107–111. 

10. Абу-Абед Ф.Н. Автоматизированная система обнаружения предаварийных ситуаций на объектах нефте-

газодобывающей промышленности // Каротажник. – 2015. – № 5 (251). – С. 48–61. 

11. Абу-Абед Ф.Н. Снижение риска при строительстве газовых скважин на базе нейросетевой модели // Га-

зовая промышленность. – 2014. – № S712 (712). – С. 100–102. 

12. Абу-Абед Ф.Н. Обнаружение предаварийных ситуаций в процессе промышленного бурения нефтяных 

скважин : дисс. … канд. техн. наук / Ф.Н. Абу-Абед. – Тверь, 2011. – 206 с. 

13. Абу-Абед Ф.Н., Допира Р.В. Применение средств моделирования нейросетей для анализа предаварий-

ных ситуаций на буровых // Программные продукты и системы. – 2010. – № 3. – С. 136–139. 

14. Абу-Абед Ф.Н. Разработка средств моделирования нейросетей // Вестник Тверского государственного 

технического университета. – 2005. – № 7. – С. 125–129. 

15. Murillo A., Neuman J., Samuel R. Pipe sticking prediction and avoidance using adaptive fuzzy logic and neural 
network modeling // Paper presented at Production and Operations Symposium held in Oklahoma City. – Oklahoma, USA, 
2009. – 15 p. – SPE 120128. 

16. Morteza E.N., Peyman E., Saeid J. Prediction of drilling pipe sticking by active learning method (ALM) // Aca-
demic  Journals.  Journal  of  Petroleum  and  Gas  Engineering.  –  2013.  –  Vol.  4(7).  –  Р.  173–183.  –  DOI: 
10.5897/JPGE2013.0166. 

17. Хайкин С. Нейронные сети: полный курс. – М. : Издательский дом «Вильямс», 2006. – 1104 с. 
18. Gulli A. Deep Learning with Keras: hand book / Antonio Gulli, Sujit Pal. – BIRMINGHAM – MUMBAI: Packt, 

2017. – 310 p. 

19. Шолле Ф. Глубокое обучение на Python : справочное пособие. – СПб. : Питер, 2018. – 400 с. 
20. Рашка С. Python и машинное обучение : справочное пособие. – М. : ДМК Пресс, 2017. – 418 с. 
21. Грас Дж. Наука о данных с нулям: учебное пособие. – СПб. : БХВ-Петербург, 2017. – 336 с. 
22. Jojo M. Learn Keras for Deep Neural Networks : hand book. – Canada : Apress, 2019. – 192 p. 
23. Ketkar  N.  Deep  Learning  with  Python  :  A  Hands-on  Introduction.  –  India  :  Apress,  2017.  –  162  p.  –  DOI 

10.1007/978-1-4842-2766-4. 

References 

1.  Samotoy A.K. Prevention and elimination of pipe clamps when drilling wells: a training manual. – M. : Nedra, 

1979. – 182 р. 

2.  Samotoy A.K., Vorotnyuk O.V. The analysis of the a priori data about the factors acting at tacking of tubing string // 

Proc. of Intern. VNIIBT. Struggle with complications at well drilling. – 1973. – Execute 7. – Р. 28–37. 

3.  Avetisov A.G., Akhmadullin M.M., Samotoy A.K. Prediction, prevention and liquidation of tackles using statistical 

methods // Thematic scientific and technical review. – M. : VNIOENG, 1977. – Р. 75–86. 

4.  Avetisov A.G., Akhmadullin M.M., Koshelev N.N. Methodical manual on recognition, forecasting and prevention 

of tackings of pipe columns by means of successive diagnostic procedure. – Krasnodar : VNIIKRneft, 1977. – 38 р. 

5.  Mirzadzhanzade A.H., Bulatov A.I., Avetisov A.G. The methodical manual on application of methods of pattern 

recognition at flushing and fixing of wells. – Krasnodar, 1974. – 42 р. 

6.  Mirzajanzade A.H., Avetisov A.G., Bulatov A.I. Methodical instructions for application of statistical methods in 

drilling of oil and gas wells. – Krasnodar, 1983. – 62 р. 

7.  Lipatov E.Yu. Research and development of technology and technical means for prevention and liquidation of 

drillstring tacking (by the example of fields of Middle Priobie) : monograph. – Tyumen : TyumGNGU, 2015. – 128 р. 

8.  Abu-Abed F.N. Development of Tools for the Analysis of Pre-Emergency Situations on the Drilling Rig Based 
on Neural Network Technologies // IIIrd International Innovative Mining Symposium. Environment Saving Mining Technol-
ogies. – 2018. – 41, 01025. – 8 p. – doi.org/10.1051/e3sconf/20184101025. 

9.  Abu-Abed F.N. Reliability of the oil and gas extracting industry objects (in Russian) // Gas industry. – 2015. – 

№ S720 (720). – Р. 107–111. 

10. Abu-Abed F.N. Automated system for detection of the preaccident situations at the oil and gas producing indus-

try objects // Karotazhnik. – 2015. – № 5 (251). – Р. 48–61. 

11. Abu-Abed  F.N.  Risk reduction  at  construction  of the gas  wells  on  the  basis  of the  neural  network model  (in 

Russian) // Gas industry. – 2014. – № S712 (712). – Р. 100–102. 

12. Abu-Abed F.N. Detection of the preaccidental situations during the industrial drilling of the oil wells : Dissertation. 

Cand. of Sciences / F.N. Abu-Abed. – F.N. Abu Abed. – Tver, 2011. – 206 р. 

13. Abu-Abed F.N., Dopira R.V. Application of neural network modeling tools for pre-accident analysis on drilling // 

Software products and systems. – 2010. – № 3. – Р. 136–139. 

14. Abu-Abed F.N. Neural network modeling means development // Vestnik of Tver State Technical University. – 

2005. – № 7. – Р. 125–129. 

153 

 
 
 
 
БУЛАТОВСКИЕ ЧТЕНИЯ 

СБОРНИК СТАТЕЙ – 2020 

15. Murillo A., Neuman J., Samuel R. Pipe sticking prediction and avoidance using adaptive fuzzy logic and neural 
network modeling // Paper presented at Production and Operations Symposium held in Oklahoma City. – Oklahoma, USA, 
2009. – 15 p. – SPE 120128. 

16. Morteza E.N., Peyman E., Saeid J. Prediction of drilling pipe sticking by active learning method (ALM) // Aca-
demic  Journals.  Journal  of  Petroleum  and  Gas  Engineering.  –  2013.  –  Vol.  4(7).  –  Р.  173–183.  –  DOI: 
10.5897/JPGE2013.0166. 

17. Haikin S. Neural networks: full course. – M. : Williams Publishing House, 2006. – 1104 р. 
18. Gulli A. Deep Learning with Keras: hand book / Antonio Gulli, Sujit Pal. – BIRMINGHAM – MUMBAI: Packt, 

2017. – 310 p. 

19. Scholle F. Deep Learning on Python: a reference book. – SPb. : Peter, 2018. – 400 р. 
20. Rushka S. Python and machine training: a reference book. – M. : DMK Press, 2017. – 418 р. 
21. Gras J. Science of Data from Zero: a Training Manual. – St. Petersburg : BHVP, 2017. – 336 р. 
22. Jojo M. Learn Keras for Deep Neural Networks : hand book. – Canada : Apress, 2019. – 192 p. 
23. Ketkar  N.  Deep  Learning  with  Python  :  A  Hands-on  Introduction.  –  India  :  Apress,  2017.  –  162  p.  –  DOI 

10.1007/978-1-4842-2766-4. 

154 

 
 
 
 
 
