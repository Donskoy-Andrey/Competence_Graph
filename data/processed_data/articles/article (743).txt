УДК 66.011 

ИСПОЛЬЗОВАНИЕ ВЫЧИСЛЯЕМЫХ ПСЕВДО-АТРИБУТОВ  

В AVEVA PDMS/E3D/DIAGRAMS ДЛЯ РАСЧЕТА КОДИРОВКИ 

КЛАССА ТРУБОПРОВОДА 

150 

USING COMPUTED PSEUDO-ATTRIBUTES  

IN AVEVA PDMS / E3D / DIAGRAMS  

FOR CALCULATION OF PIPING CLASS CODING 

В.Р. Нигматуллин, В.В. Казаков, Н.Д. Михайлова,  

Ф.Ф. Риянов, С.М. Мавлютова 

Уфимский государственный нефтяной технический университет, 

г. Уфа, Российская Федерация 

Vil' R. Nigmatullin,  Viktor V. Kazakov, Nadezhda D. Mikhailova,  

Fanis F. Riyanov, Svetlana M. Mavlyutova 

Ufa State Petroleum Technological University, 

Ufa, Russian Federation 

e-mail: ikafedraig@mail.ru 

Аннотация. Статья посвящена проблеме автоматизации и оптимизации 

процесса проектирования объектов в нефтегазохимической отрасли за счет 

внедрения  интеллектуальных  алгоритмов  при  расчете  кодировки  класса 

трубопроводов  в  системе  AVEVA  PDMS/E3D/DIAGRAMS.  В  ходе 

проектных  работ  часто  возникает  задача  назначения  трубопроводу 

определенного  класса  в  зависимости  от  материала,  среды,  условий 

эксплуатации.  Применение  пользовательских  псевдо-атрибутов  для 

динамического расчета кодировки  класса трубопровода позволяет решить 

эту  задачу.  Реализована  программа  на  языке  С#  для  регистрации  псевдо-

атрибута  через  предоставляемый  программный  интерфейс  приложения 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
151 

(API  –  application  programming  interface).  Полученный  в  ходе  работы 

результат  позволяет  быстро  и  качественно  в  автоматическом  режиме  на 

основе  технологических  параметров  трубопровода  определить  кодировку 

класса. 

Abstract.  The  article  is  devoted  to  the  problem  of  automation  and 

optimization  of  the  process  of  designing  objects  in  the  petrochemical  industry 

due  to  the  introduction  of  intelligent  algorithms  when  calculating  the  class 

encoding of pipelines in the AVEVA PDMS / E3D / DIAGRAMS system. In the 

process of design, the task often arises of assigning a certain class of pipeline to 

a  pipeline  depending  on  the  material,  environment,  and  operating  conditions. 

The use of custom pseudo-attributes for the dynamic calculation of the encoding 

of  a  class  of  a  pipeline  allows  us  to  solve  this  problem.  A  C  #  program  was 

implemented  to  register  a  pseudo-attribute  through  the  provided  application 

programming  interface  (API  –  application  programming  interface).  The  result 

obtained  in  the  process  of  work  allows  you  to  quickly  and  efficiently 

automatically determine the class coding based on the technological parameters 

of the pipeline. 

Ключевые слова: AVEVA; DIAGRAMS; PDMS; E3D; псевдо-атрибут; 

класс трубопровода 

Key  words:  AVEVA;  DIAGRAMS;  PDMS;  E3D;  pseudo-attribute; 

pipeline class 

В продуктах САПР компании Aveva принято хранить дополнительную 

пользовательскую  информацию  об  элементах  модели  в  атрибутах  (User 

Defined  Attributes,  или  UDA).  UDA  [1]  бывают  двух  типов  –  обычные  и 

псевдо-атрибуты.  Отличие  псевдо-атрибута  от  обычного  заключается  в 

том,  что  псевдо-атрибут  вычисляется  динамически  на  основе  различных 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
152 

исходных  данных  (включая  данные,  полученные  на  основе  других 

атрибутов). 

В данной статье будет показано применение пользовательских псевдо-

атрибутов  для  динамического  расчета  кодировки  класса  трубопровода. 

Необходимую  логику  можно  применить  как  к  элементам  типа  PIPE, 

используемым  в  модуле  DESIGN  (MODEL),  так  и  к  элементам  SCPLIN, 

используемым в Diagrams.  

Для  использования  псевдо-атрибута  необходимо  написать  модуль  на 

С#  через  предоставляемый  программный  интерфейс  приложения  (API  – 

application programming interface). 

Для  начала  определимся 

с  методикой  кодирования  классов 

трубопроводов  (таблицы  1–5).  Возьмем  для  примера  класс  B025A1v  и 

расшифруем. 

Таблица 1. Расшифровка класса B025A1v 

B 

025 

A 

1 

v 

Символ 
материала 

Давление 

Символ 
продукта 

Прибавка  
на коррозию 

Дополнитель
ный символ 

Таблица 2. Символы материала 

Символ  Материал 

A 

B 

C 

D 

E 

Сталь 20, Сталь 17Г1С  

Сталь 09Г2С 

Сталь 08Х18Н10Т 

Сталь 12Х18Н10Т 

Сталь 15Х5М 

Ряд допустимые значений давлений (кгс/см2  в именовании класса [2]: 

016, 025, 040, 063, 100, 160, 250, 420. 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
153 

Таблица 3. Символы продуктов 

Символ  Условия среды 

A 

B 

C 

D 

E 

F 

Углеводородные и общие технологические линии  
(с термообработкой) 

Углеводородные и общие технологические линии  
(без термообработки) 

Факельные системы  

Вода 

Воздух КИП, воздух технический, азот 

Пар, конденсат, горячая вода 

Таблица 4. Прибавки на коррозию 

Символ 

0 

1 

2 

3 

4 

5 

Допуск  
(мм) 

нет 

до 1 

до 2 

до 3 

до 4 

до 5 

Таблица 5. Дополнительные символы 

Символ 

Условия 

v 

I 

а 

b 

Вакуум 

Трубопроводы  групп  А,  Б,  относящиеся  к  блоку  I  категории 
взрывоопасности 

Трубопроводы групп А(а) 

Трубопроводы групп А, Б 

Для  создания  псевдо-атрибута  (рисунок  1)  необходимо  пройти  два 

этапа:  добавление  превдо-атрибута  (PseudoUDA)  в  модуле  Lexicon  и 

подключение  кода  (регистрация  делегата),  который  будет  содержать 

логику вычисления псевдо-атрибута. 

После  перехода  в  модуль  Lexicon  создадим  необходимые  элементы,  в 

частности,  создадим  мир  UWRL 

(пространство  пользовательских 

атрибутов) для хранения UDA, а также сам псевдо-атрибут: PipeClass. 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
154 

Рисунок 1. Добавление превдо-атрибута 

В дальнейшем необходимо написать модуль на языке C#, содержащий 

основную  логику  вычисления  кодировки  класса  трубопровода,  а  также 

механизм регистрации функции вычисления псевдо-атрибута. 

Код регистрации делегата (функции) псевдо-атрибута: 

Как  можно  видеть  из  кода,  основная  логика  расчета  атрибута  будет 

заключена  в  функции  AttributeValueCalculation.  Как  только  среда  САПР 

Aveva  посчитает  нужным  получить 

значение  кодировки  класса, 

автоматически будет вызвана эта функция и произведен расчет. 

Рассмотрим основные составные блоки данной функции. 

Символ материала получаем путем анализа текстового атрибута трубы 

:Material,  впоследствии  по  значению  ищется  соответствие  согласно 

словарю символов материалов. 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
 
 
155 

Символ давления подбирается согласно ГОСТ 356-80 [2]. При этом по 

расчетному  давлению  подбирается  номинальное  давление,  по  которому  и 

определяется кодировка класса по давлению. Под номинальным давлением 

следует  понимать  наибольшее  избыточное  давление  при  температуре 

среды 293 К (20 °С), при котором допустима длительная работа арматуры 

и  деталей  трубопровода,  имеющих  заданные  размеры,  обоснованные 

расчетом  на  прочность  при  выбранных  материалах  и  характеристиках  их 

прочности,  соответствующих  температуре  293  К  (20  °С).  Также  при  этом 

учитывается материал трубопровода. 

Символ  продукта  определяется  путем  извлечения  символа  из  объекта, 

описывающего свойства технологической среды трубопровода (FLUREF – 

ссылка на среду). 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
 
 
 
156 

Символ коррозии определяется умножением скорости коррозии на срок 

службы и последующим округлением до ближайшего целого числа. 

Дополнительный  символ  зависит от  группы  трубопровода,  давления  и 

принадлежности к блоку I категории взрывоопасности. 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
 
 
 
157 

В итоге искомая величина псевдо-атрибута :PipeClass будет собрана из 

составляющих  частей.  При  этом,  если  по  какой-либо  причине  вычислить 

какую-либо  из  частей  не  удалось,  произойдет  подстановка  знаков  ?,  что 

будет 

являться 

сигналом 

для 

проверки 

исходных 

данных 

проектировщиком. 

При  выборе  элемента  типа  SCPLIN  (трубопровод)  мы  видим  наш 

атрибут  и  полученное  значение,  вычисляемое  динамически  на  основе 

исходных атрибутов трубопровода (рисунок 2). 

Рисунок 2. Выбор элемента типа SCPLIN 

Данные  инструменты  были  апробированы  в  рамках  созданного  в 

УГНТУ  «Технологического  центра  компании  AVEVA».  Полученный  в 

ходе  работ  результат  позволяет  быстро  и  качественно  в  автоматическом 

режиме  на  основе  заданных  технологических  параметров  трубопровода 

определить кодировку класса. 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
 
 
158 

Вывод 

Реализована  программа  на  языке  С#  для  регистрации  псевдо-атрибута 

через  предоставляемый  API.  Полученный  результат  позволяет  быстро  и 

качественно  в  автоматическом  режиме  на  основе  технологических 

параметров трубопровода определить кодировку класса  

Список используемых источников 

1.  Aveva 

– 

вычисляемые 

псевдо-атрибуты 

// 

SMFD.RU.  

URL: 

http://smfd.ru/blog/aveva-pseudo-attributes 

(дата 

обращения: 

24.04.2019). 

2.  ГОСТ  356-80  (СТ  СЭВ  253-76).  Арматура  и  детали  трубопроводов. 

Давления  номинальные,  пробные  и  рабочие.  Ряды.  М.:  Стандартинформ, 

2006. 20 с. 

References 

1.  Aveva  –  vychislyaemye  psevdo-atributy  [Aveva-Calculated  Pseudo-

Attributes]. SMFD.RU. Available at: http://smfd.ru/blog/aveva-pseudo-attributes 

(accessed 24.04.2019). [in Russian]. 

2.  GOST  356-80  (ST  SEV  253-76).  Armatura  i  detali  truboprovodov. 

Davleniya  nominal'nye,  probnye  i  rabochie.  Ryady  [State  Standard  356-80 

(ST SEV  253-76).  Valves  and  Parts  of  Pipe-Lines.  Nominal,  Test  and 

Operational  Pressures.  Series].  Moscow,  Standartinform  Publ.,  2006.  20  p. 

[in Russian]. 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
 
159 

Сведения об авторах  

About the authors 

Нигматуллин  Виль  Ришатович,  канд.  техн.  наук,  доцент,  заведующий 

кафедрой «Комплексный инжиниринг и компьютерная графика»,  УГНТУ, 

г. Уфа, Российская Федерация 

Vil' R. Nigmatullin, Candidate of Engineering Sciences, Assistant Professor, 

Head  of  Integrated  Engineering  and  Computer  Graphics  Department,  USPTU, 

Ufa, Russian Federation 

e-mail: ikafedraig@mail.ru 

Казаков  Виктор  Викторович,  магистрант  кафедры  «Комплексный 

инжиниринг  и  компьютерная  графика»,  УГНТУ,  г.  Уфа,  Российская 

Федерация 

Viktor  V.  Kazakov,  Undergraduate  Student  of Integrated  Engineering  and 

Computer Graphics Department, USPTU, Ufa, Russian Federation 

e-mail: kazakov.vityusha83@mail.ru 

Михайлова Надежда Геннадьевна, магистрант кафедры «Комплексный 

инжиниринг  и  компьютерная  графика»,  УГНТУ,  г.  Уфа,  Российская 

Федерация 

Nadezhda G. Mikhailova, Undergraduate Student of Integrated Engineering 

and Computer Graphics Department, USPTU, Ufa, Russian Federation 

e-mail: Nadusha-mihailova@mail.ru 

Риянов  Фанис  Фанурович,  магистрант  кафедры  «Комплексный 

инжиниринг  и  компьютерная  графика»,  УГНТУ,  г.  Уфа,  Российская 

Федерация 

Fanis  F.  Riyanov,  Undergraduate  Student  of  Integrated  Engineering  and 

Computer Graphics Department, USPTU, Ufa, Russian Federation 

е-mail: fanis.riyanov@mail.ru 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
 
 
 
160 

Мавлютова  Светлана  Мазитовна,  ассистент  кафедры  «Комплексный 

инжиниринг  и  компьютерная  графика»,  УГНТУ,  г.  Уфа,  Российская 

Федерация 

Svetlana M. Mavlyutova, Assistant of Integrated Engineering and Computer 

Graphics Department, USPTU, Ufa, Russian Federation 

e-mail: mavsveta@mail.ru 

© Сетевое издание «Нефтегазовое дело». 2019. №6 

http://ogbus.ru 

 
